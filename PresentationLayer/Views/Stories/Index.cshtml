@model IEnumerable<BusinessLayer.Story>
@using BusinessLayer;

@{
    ViewData["Title"] = "Index";
    var approvedStoryFirst = Model.FirstOrDefault(s => s.Status == Status.Approved);
    string? firstImageUrl = approvedStoryFirst?.ImageUrls?.FirstOrDefault();
    string firstTitle = approvedStoryFirst?.Title ?? "Default Title";
    string firstContent = approvedStoryFirst?.Content ?? "Default Content";
    var words = firstContent.Split(' ', StringSplitOptions.RemoveEmptyEntries);
    string shortContentFirst = string.Join(' ', words.Take(20)) + (words.Length > 20 ? "..." : "");

    var approvedStorySecond = Model.Skip(1).FirstOrDefault(s => s.Status == Status.Approved);
    string? secondImageUrl = approvedStorySecond?.ImageUrls?.FirstOrDefault();
    string secondTitle = approvedStorySecond?.Title ?? "Default Title";
    string secondContent = approvedStorySecond?.Content ?? "Default Content";
    var wordsSecond = secondContent.Split(' ', StringSplitOptions.RemoveEmptyEntries);
    string shortContentSecond = string.Join(' ', wordsSecond.Take(20)) + (wordsSecond.Length > 20 ? "..." : "");

    var approvedStoryThird = Model.Skip(2).FirstOrDefault(s => s.Status == Status.Approved);
    string? thirdImageUrl = approvedStoryThird?.ImageUrls?.FirstOrDefault();
    string thirdTitle = approvedStoryThird?.Title ?? "Default Title";
    string thirdContent = approvedStoryThird?.Content ?? "Default Content";
    var wordsThird = thirdContent.Split(' ', StringSplitOptions.RemoveEmptyEntries);
    string shortContentThird = string.Join(' ', wordsThird.Take(20)) + (wordsThird.Length > 20 ? "..." : "");
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Generated by Codia AI</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:wght@400&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@500&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500&display=swap" />
    <link rel="stylesheet" href="~/css/storyIndex.css" />
</head>
<body>
    <div class="main-container">
        <div class="header">
            <div class="frame"></div>
            <div class="frame-2">
                <span class="get-to-know-world">Get to Know THE WORLD Better</span><span class="unique-journeys-tailored">unique journeys tailored By The historians of TripTale</span>
            </div>
        </div>
        <span class="discover-perfect-travel">Discover Your Perfect Travel Experience</span>
        <div class="rectangle"></div>
        <span class="passion-for-exploring">
            Our site, rooted in the passion for exploring the world, prides itself
            on curating bespoke travel experiences that go beyond the ordinary. From
            the azure waters of the Caribbean to the ancient architecture of Rome,
            we explore all corners of the world to bring you the best in travel. We
            believe that travel is more than just visiting a destination, it's about
            immersing oneself in the culture, history, and life of the place.
        </span>
        <div class="frame-3">
           @*  First card *@
            <a asp-action="Read" asp-route-id="@approvedStoryFirst?.Id" style="text-decoration: none; color: inherit;">
                <div class="card">
                    @if (firstTitle != null && firstTitle != "Default Title")
                    {
                        <span class="story-1">@firstTitle</span>
                    }
                    else
                    {
                        <span class="story-1">Story 1</span>
                    }
                    <div class="frame-4">
                        @if (firstTitle != null && firstContent != "Default Content")
                        {
                            <span class="unique-itineraries-tailored">
                                @shortContentFirst
                            </span>
                        }
                        else
                        {
                            <span class="unique-itineraries-tailored">
                                Our travel experts create unique itineraries tailored to your
                                interests and preferences. We take into account your desired
                                destinations, activities, and budget, creating a bespoke travel
                                experience you'll cherish.
                            </span>
                        }
                    </div>
                    <div class="bg"></div>
                    @* For the background images of the first story *@
                    @if (firstImageUrl != null)
                    {
                        <div class="overlay" style="background-image: url('@firstImageUrl'); background-size: cover; background-position: center;"></div>
                    }
                    else
                    {
                        <div class="overlay"></div> <!-- Empty overlay if no image found -->
                    }
                </div>
            </a>
            

            @*  Second card *@
            <div class="card-5">
                @if (secondTitle != null && secondTitle != "Default Title")
                {
                    <span class="story-2">@secondTitle</span>
                }
                else
                {
                    <span class="story-2">Story 2</span>
                }
                <div class="frame-6">
                    @if (secondTitle != null && secondContent != "Default Content")
                    {
                        <span class="text-content">
                            @shortContentSecond
                        </span>
                    }
                    else
                    {
                        <span class="text-content">
                            With established partnerships across the globe, we ensure
                            reliable and quality service wherever you travel. From hotels to
                            transport providers, our connections bring you the best travel
                            experience.
                        </span>
                    }
                </div>
                <div class="bg-7"></div>
                @if (secondImageUrl != null)
                {
                    <div class="overlay-8" style="background-image: url('@secondImageUrl'); background-size: cover; background-position: center;"></div>
                }
                else
                {
                    <div class="overlay-8" style="background-color:#2f4f4f"></div>
                }
                
            </div>

            @*  Third card *@
            <div class="card-9">
                @if (thirdTitle != null && thirdTitle != "Default Title" )
                {
                    <span class="story">@thirdTitle</span>
                }
                else
                {
                    <span class="story">Story 3</span>
                }
                
                <div class="frame-a">
                    @if (thirdTitle != null && thirdContent != "Default Content")
                    {
                        <span class="text-content-b">
                            @shortContentThird
                        </span>
                    }
                    else
                    {
                        <span class="text-content-b">
                            We're committed to supporting your travel journey around the
                            clock. Our dedicated support team is always on standby to assist
                            with any queries or issues, ensuring a seamless and worry-free
                            journey.
                        </span>
                    }
                    
                </div>
                <div class="bg-c"></div>
                @if (thirdImageUrl != null)
                {
                    <div class="overlay-d" style="background-image: url('@thirdImageUrl'); background-size: cover; background-position: center;"></div>
                }
                else
                {
                    <div class="overlay-d"></div>
                }
            </div>
        </div>
        <div class="unnamed-e" id="read-more">
            <span class="read-more">Read MOre stories</span>
        </div>
        @*   @{
            var redirectUrl = User.Identity?.IsAuthenticated == true
            ? Url.Content("~/Stories/Create")
            : Url.Content("~/Areas/Identity/Pages/Account/Login.cshtml");
        }
        <a href="@redirectUrl" style="position: relative; width: 207px; height: 50px; margin: 228px 0 0 775px; background: rgba(96,161,160,0.85); border-radius: 4px; display: block; text-decoration: none; z-index: 28; overflow: hidden;">
            <span style="display: flex; align-items: flex-start; justify-content: center; position: absolute; width: 135px; height: 18px; top: 16px; left: 36px; color: #ffffff; font-family: Poppins, sans-serif; font-size: 16px; font-weight: 500; line-height: 18px; text-align: center; text-transform: uppercase; white-space: nowrap; letter-spacing: 1.6px; z-index: 29;">
                get started
            </span>
        </a> *@

        @if (!User.Identity.IsAuthenticated)
        {
            <a href="#" data-bs-toggle="modal" data-bs-target="#loginModal" style="position: relative; width: 207px; height: 50px; margin: 228px 0 0 775px; background: rgba(96,161,160,0.85); border-radius: 4px; display: block; text-decoration: none; z-index: 28; overflow: hidden;">
                <span  style="display: flex; align-items: flex-start; justify-content: center; position: absolute; width: 135px; height: 18px; top: 16px; left: 36px; color: #ffffff; font-family: Poppins, sans-serif; font-size: 16px; font-weight: 500; line-height: 18px; text-align: center; text-transform: uppercase; white-space: nowrap; letter-spacing: 1.6px; z-index: 29;">
                    get started
                </span>
            </a>
        }
        @if (User.IsInRole("User"))
        {
            <a href="#" data-bs-toggle="modal" data-bs-target="#userModal" style="position: relative; width: 207px; height: 50px; margin: 228px 0 0 775px; background: rgba(96,161,160,0.85); border-radius: 4px; display: block; text-decoration: none; z-index: 28; overflow: hidden;">
                <span style="display: flex; align-items: flex-start; justify-content: center; position: absolute; width: 135px; height: 18px; top: 16px; left: 36px; color: #ffffff; font-family: Poppins, sans-serif; font-size: 16px; font-weight: 500; line-height: 18px; text-align: center; text-transform: uppercase; white-space: nowrap; letter-spacing: 1.6px; z-index: 29;">
                    get started
                </span>
            </a>
        }
        @if (User.IsInRole("Historian"))
        {
            <a href="~/Stories/Create" style="position: relative; width: 207px; height: 50px; margin: 228px 0 0 775px; background: rgba(96,161,160,0.85); border-radius: 4px; display: block; text-decoration: none; z-index: 28; overflow: hidden;">
                <span style="display: flex; align-items: flex-start; justify-content: center; position: absolute; width: 135px; height: 18px; top: 16px; left: 36px; color: #ffffff; font-family: Poppins, sans-serif; font-size: 16px; font-weight: 500; line-height: 18px; text-align: center; text-transform: uppercase; white-space: nowrap; letter-spacing: 1.6px; z-index: 29;">
                    get started
                </span>
            </a>
        }

        <div class="rectangle-10"></div>
       @*  <div class="footer">
            <div class="flex-row">
                <span class="rhodes">Rhodes</span><span class="address">Address</span><span class="contact">Contact</span><span class="follow-us">Follow us</span>
            </div>
            <div class="flex-row-bb">
                <div class="rectangle-11"></div>
                <div class="rectangle-12"></div>
                <div class="rectangle-13"></div>
            </div>
            <div class="flex-row-ed">
                <span class="contact-info">+33 1 23 45 67 89</span><span class="social-media">Facebook</span><span class="copyright">©2024 Rhodes. <br />All rights reserved.</span><span class="address-14">8, Rue de la Paix, 75002 Paris, France</span><span class="email">contact@email.com</span><span class="social-media-15">Instagram</span>
            </div>
            <div class="frame-16">
                <span class="terms-conditions">Terms & Conditions</span><span class="privacy-policy">privacy policy</span>
            </div>
        </div> *@

        @* Dialog for unauthenticated users *@
        <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="loginModalLabel">Login Required</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        You need to be logged in to start planning a trip.
                    </div>
                    <div class="modal-footer">
                        <a class="btn btn-primary" asp-area="Identity" asp-page="/Account/Login">Log In</a>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
        @* Dialog for users who wants to make stories but is not a historian*@
        <div class="modal fade" id="userModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="loginModalLabel">Historian role Required</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        You need to be a historian to start planning a trip.
                        To be granted the the historian role, you need to have atleast 3 trips.
                    </div>
                    <div class="modal-footer">
                        <a class="btn btn-primary" asp-controller="Trips" asp-action="Create">Create a trip</a>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    </div>
                </div>
            </div>
        </div>

        <span class="own-story" id="ownstory">Ready for Your own Story?</span><span class="fascinating-places">
            Write about the most fascinating places in your view and share with
            others the magic of exploring, discovering and experiencing new
            places.
        </span>
        <div class="section"></div>
    </div>
</body>
</html>
